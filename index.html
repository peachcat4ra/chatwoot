<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chatwoot Reactivation Page</title>
</head>
<body>
  <h2>Связь с оператором...</h2>
  <p>Сейчас откроется чат для вас. Пожалуйста, подождите.</p>

  <script>
    const params = new URLSearchParams(window.location.search);
    const uuid = params.get('uuid') || 'unknown';
    const bonus_id = params.get('bonus_id') || 'none';
    const campaign_name = params.get('campaign_name') || 'unknown';
    const label = params.get('label') || 'реактивация';
    const domain = params.get('domain') || 'no-domain';
    const last_online = params.get('last_online') || 'not_set';
    const tz_offset = params.get('tz_offset') || '0';

    window.chatwootSettings = {
      websiteToken: "JNZ9fwgTkAVY6xq8BhKPEpWr",
      baseUrl: "https://app.chatwoot.com",
      showPopup: true,
      customAttributes: {
        uuid: uuid,
        bonus_id: bonus_id,
        campaign_name: campaign_name,
        type: label,
        domain: domain,
        last_online: last_online,
        tz_offset: tz_offset
      }
    };

    (function(d,t) {
      var BASE_URL = window.chatwootSettings.baseUrl;
      var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src= BASE_URL + "/packs/js/sdk.js";
      g.defer = true;
      g.async = true;
      s.parentNode.insertBefore(g,s);
    })(document,"script");

    function trySendMessage() {
      if (window.$chatwoot) {
        window.$chatwoot.sendMessage("Здравствуйте, хочу активировать бонус.");
      } else {
        setTimeout(trySendMessage, 500);
      }
    }

    setTimeout(trySendMessage, 2000);
  </script>
</body>
</html>
